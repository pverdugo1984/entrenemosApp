{
  "version": 3,
  "sources": ["src/app/features/user/perfil/perfil.ts", "src/app/features/user/perfil/perfil.html"],
  "sourcesContent": ["import { Component, OnInit, inject } from \"@angular/core\";\nimport { CommonModule } from \"@angular/common\";\nimport { Router } from \"@angular/router\";\nimport { Header } from \"../../../shared/components/header/header\";\nimport { BottomNav } from \"../../../shared/components/bottom-nav/bottom-nav\";\nimport { UserProfile } from \"../../../shared/components/user-profile/user-profile\";\nimport { AuthService } from \"../../../core/services/auth.service\";\nimport { ProgresoService } from \"../../../core/services/progreso.service\";\nimport { Usuario } from \"../../../shared/models/usuario\";\nimport { Progreso } from \"../../../shared/models/progreso.model\";\n\n@Component({\n  selector: \"app-perfil\",\n  imports: [CommonModule, Header, BottomNav, UserProfile],\n  templateUrl: \"./perfil.html\",\n  styleUrl: \"./perfil.css\",\n})\nexport class Perfil implements OnInit {\n  private authService = inject(AuthService);\n  private progresoService = inject(ProgresoService);\n  router = inject(Router);\n\n  usuario: Usuario | null = null;\n  progresos: Progreso[] = [];\n  loading = true;\n  error: string | null = null;\n\n  onFotoActualizada(usuario: Usuario): void {\n    this.usuario = usuario;\n  }\n\n  // Estad铆sticas\n  totalProgresos = 0;\n  totalSesiones = 0;\n\n  ngOnInit() {\n    this.cargarDatos();\n  }\n\n  cargarDatos() {\n    this.loading = true;\n    this.error = null;\n\n    if (!this.authService.isAuthenticated()) {\n      this.router.navigate([\"/login\"]);\n      return;\n    }\n\n    this.authService.getCurrentUser().subscribe({\n      next: (usuario: Usuario) => {\n        this.usuario = usuario;\n        if (usuario.id) {\n          this.cargarProgresos(usuario.id);\n        }\n        this.loading = false;\n      },\n      error: (err: any) => {\n        console.error(\"Error al cargar usuario:\", err);\n        this.error = \"Error al cargar la informaci贸n del usuario\";\n        this.loading = false;\n      },\n    });\n  }\n\n  cargarProgresos(usuarioId: number) {\n    this.progresoService.obtenerPorUsuario(usuarioId).subscribe({\n      next: (progresos) => {\n        this.progresos = progresos;\n        this.totalProgresos = progresos.length;\n        // Contar sesiones 煤nicas (agrupadas por fecha)\n        const sesionesUnicas = new Set(\n          progresos.map((p) => p.fecha).filter(Boolean)\n        );\n        this.totalSesiones = sesionesUnicas.size;\n      },\n      error: (err) => {\n        console.error(\"Error al cargar progresos:\", err);\n      },\n    });\n  }\n\n  formatearFecha(fecha?: string): string {\n    if (!fecha) return \"No disponible\";\n    try {\n      const date = new Date(fecha);\n      return date.toLocaleDateString(\"es-ES\", {\n        year: \"numeric\",\n        month: \"long\",\n        day: \"numeric\",\n      });\n    } catch {\n      return fecha;\n    }\n  }\n\n  cerrarSesion() {\n    this.authService.logout();\n  }\n}\n", "<div class=\"app-container\">\n    <app-header />\n\n    <main class=\"main-content\">\n        @if (loading) {\n        <div class=\"loading-container\">\n            <div class=\"spinner\"></div>\n            <p>Cargando perfil...</p>\n        </div>\n        } @else if (error) {\n        <div class=\"error-container\">\n            <p>{{ error }}</p>\n            <button (click)=\"cargarDatos()\" class=\"retry-button\">Reintentar</button>\n        </div>\n        } @else if (usuario) {\n        <!-- Informaci贸n del usuario -->\n        <section class=\"profile-section\">\n            <div class=\"profile-header\">\n                <h1 class=\"page-title\">Mi Perfil</h1>\n            </div>\n            <app-user-profile [usuario]=\"usuario\" (fotoActualizada)=\"onFotoActualizada($event)\" />\n        </section>\n\n        <!-- Informaci贸n detallada -->\n        <section class=\"info-section\">\n            <div class=\"info-card\">\n                <div class=\"info-icon\"></div>\n                <div class=\"info-content\">\n                    <p class=\"info-label\">Email</p>\n                    <p class=\"info-value\">{{ usuario.email }}</p>\n                </div>\n            </div>\n\n            @if (usuario.telefono) {\n            <div class=\"info-card\">\n                <div class=\"info-icon\"></div>\n                <div class=\"info-content\">\n                    <p class=\"info-label\">Tel茅fono</p>\n                    <p class=\"info-value\">{{ usuario.telefono }}</p>\n                </div>\n            </div>\n            }\n\n            @if (usuario.fechaRegistro) {\n            <div class=\"info-card\">\n                <div class=\"info-icon\"></div>\n                <div class=\"info-content\">\n                    <p class=\"info-label\">Miembro desde</p>\n                    <p class=\"info-value\">{{ formatearFecha(usuario.fechaRegistro) }}</p>\n                </div>\n            </div>\n            }\n\n            <div class=\"info-card\">\n                <div class=\"info-icon\"></div>\n                <div class=\"info-content\">\n                    <p class=\"info-label\">Rol</p>\n                    <p class=\"info-value\">{{ usuario.rol }}</p>\n                </div>\n            </div>\n        </section>\n\n        <!-- Estad铆sticas -->\n        <section class=\"stats-section\">\n            <h2 class=\"section-title\">Estad铆sticas</h2>\n            <div class=\"stats-grid\">\n                <div class=\"stat-card\">\n                    <div class=\"stat-icon\"></div>\n                    <div class=\"stat-content\">\n                        <p class=\"stat-value\">{{ totalProgresos }}</p>\n                        <p class=\"stat-label\">Progresos</p>\n                    </div>\n                </div>\n\n                <div class=\"stat-card\">\n                    <div class=\"stat-icon\"></div>\n                    <div class=\"stat-content\">\n                        <p class=\"stat-value\">{{ totalSesiones }}</p>\n                        <p class=\"stat-label\">Sesiones</p>\n                    </div>\n                </div>\n            </div>\n        </section>\n\n        <!-- Acciones -->\n        <section class=\"actions-section\">\n            <button class=\"logout-button\" (click)=\"cerrarSesion()\">\n                <span class=\"logout-icon\"></span>\n                <span class=\"logout-text\">Cerrar Sesi贸n</span>\n            </button>\n        </section>\n        } @else {\n        <div class=\"empty-container\">\n            <p>No se pudo cargar la informaci贸n del usuario</p>\n            <button (click)=\"cargarDatos()\" class=\"retry-button\">Reintentar</button>\n        </div>\n        }\n    </main>\n\n    <app-bottom-nav />\n</div>"],
  "mappings": "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",
  "names": []
}
